"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[367],{199:(e,r,a)=>{a.d(r,{A:()=>i});var t=a(5155),s=a(2115);let i=e=>{let{isOpen:r,onClose:a,shareUrl:i,title:l="Share Library"}=e,[n,c]=(0,s.useState)(!1),[o,d]=(0,s.useState)(!1);(0,s.useEffect)(()=>{d("undefined"!=typeof navigator&&"share"in navigator)},[]);let u=async()=>{try{await navigator.clipboard.writeText(i),c(!0),setTimeout(()=>c(!1),2e3)}catch(e){console.error("Failed to copy:",e)}},m=async()=>{if(o)try{await navigator.share({title:l,url:i})}catch(e){console.error("Error sharing:",e)}else u()};return r?(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black/50 transition-opacity duration-300",onClick:a}),(0,t.jsxs)("div",{className:"relative bg-[#141823] border border-gray-500 rounded-lg p-6 w-full max-w-md mx-4 shadow-xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-white",children:l}),(0,t.jsx)("button",{onClick:a,className:"text-gray-400 hover:text-white transition-colors",children:(0,t.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Library URL"}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"text",value:i,readOnly:!0,className:"flex-1 p-2 bg-[#181e2c] border border-gray-500 rounded text-white text-sm"}),(0,t.jsx)("button",{onClick:u,className:"px-3 py-2 text-sm rounded transition-colors ".concat(n?"bg-green-600 text-white":"bg-[#616dc9] text-white hover:bg-[#5159b3]"),children:n?"Copied!":"Copy"})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:o&&(0,t.jsxs)("button",{onClick:m,className:"w-full flex items-center justify-center space-x-2 p-3 bg-[#616dc9] text-white rounded hover:bg-[#5159b3] transition-colors",children:[(0,t.jsx)("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 24 24",children:(0,t.jsx)("path",{d:"M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92s2.92-1.31 2.92-2.92S19.61 16.08 18 16.08z"})}),(0,t.jsx)("span",{children:"Share"})]})}),(0,t.jsx)("div",{className:"mt-4 pt-4 border-t border-gray-600",children:(0,t.jsx)("button",{onClick:a,className:"w-full p-2 text-gray-400 hover:text-white transition-colors",children:"Close"})})]})]}):null}},4204:(e,r,a)=>{a.d(r,{A:()=>o});var t=a(5155),s=a(4746),i=a(9265),l=a(5393),n=a(5317),c=a(2115);let o=e=>{let{paramID:r}=e,[a,o]=(0,c.useState)({mythics:0,rares:0,uncommons:0,commons:0}),[d,u]=(0,c.useState)(0),[m,x]=(0,c.useState)(0),b=(0,c.useContext)(i.Q),p=(0,l.Q)();if(!b)throw Error("BinderContext not found.");let{currentBinder:f,cardsUpdated:h}=b;(0,c.useEffect)(()=>{(p||r)&&g(f)},[f,p,h]);let g=async e=>{try{if(!e)return void console.error("user or binder not found");let a=r||(p?p.uid:null);if(!a)return;let t={mythics:0,rares:0,uncommons:0,commons:0},i=0,l=0;(await (0,n.getDocs)((0,n.collection)(s.db,"users",a,"binders",e,"cards"))).forEach(e=>{let r=e.data();switch(r.rarity){case"mythic":t.mythics++;break;case"rare":t.rares++;break;case"uncommon":t.uncommons++;break;case"common":t.commons++;break;default:console.warn("Unknown rarity: ".concat(r.card_name))}i++,l+=Number(r.prices.usd)}),x(Number(l.toFixed(2))),u(i),o(t)}catch(e){console.error("Couldn't get rarities: ".concat(e))}};return(0,t.jsxs)("div",{className:"absolute bottom-7 right-14 z-10 font-normal",children:[(0,t.jsxs)("div",{className:"absolute right-3 -top-5 flex",children:[(0,t.jsx)("img",{src:"/tbgplayermono.svg",className:"relative -top-0.4 w-7"}),(0,t.jsxs)("p",{className:"ml-0",children:["$",m]}),(0,t.jsxs)("p",{className:"ml-6",children:[d," cards"]})]}),(0,t.jsxs)("div",{className:"flex text-gray-400",children:[(0,t.jsxs)("p",{className:"m-2",children:[a.mythics," mythics"]}),(0,t.jsxs)("p",{className:"m-2",children:[a.rares," rares"]}),(0,t.jsxs)("p",{className:"m-2",children:[a.uncommons," uncommons"]}),(0,t.jsxs)("p",{className:"m-2",children:[a.commons," commons"]})]})]})}},4746:(e,r,a)=>{a.d(r,{db:()=>c,j:()=>n});var t=a(3915),s=a(6203),i=a(5317);let l=(0,t.Dk)().length?(0,t.Dk)()[0]:(0,t.Wp)({apiKey:"AIzaSyAG8nkDy9a4f3VaPzNyKFCbAL7vAWXP39E",authDomain:"manavault-e2506.firebaseapp.com",projectId:"manavault-e2506",storageBucket:"manavault-e2506.firebasestorage.app",messagingSenderId:"384906228232",appId:"1:384906228232:web:1902c364b45ba6a2c617bd",measurementId:"G-5XN99F3RBC"}),n=(0,s.xI)(l),c=(0,i.getFirestore)(l)},5360:(e,r,a)=>{a.d(r,{z:()=>t});function t(e,r){return{id:"N/A",card_name:e.name,flavor_name:e.flavor_name,image_uris:e.image_uris||e.card_faces[0].image_uris,add_date:new Date,last_price_update:new Date,binder:r,condition:"NM",scryfallId:e.id,tcgplayerId:e.tcgplayer_id,tcgplayerEtchedId:e.tcgplayer_etched_id,cardMarketId:e.card_market_id,lang:e.lang,layout:e.layout,uri:e.uri,scryfallUri:e.scryfall_uri,prints_search_uri:e.prints_search_uri,collector_number:e.collector_number,all_parts:e.all_parts?e.all_parts.map(e=>({name:e.name})):[],card_faces:e.card_faces?e.card_faces.map(e=>({name:e.name,image_uris:e.image_uris})):[],cmc:e.cmc,color_identity:e.color_identity,color_indicator:e.color_indicator,colors:e.colors,defense:e.defense,edhrank:e.edhrec_rank,game_changer:e.game_changer,keywords:e.keywords,legality:e.legalities,loyalty:e.loyalty,mana_cost:e.mana_cost,oracle_text:e.oracle_text,power:e.power,produced_mana:e.produced_mana,reserved:e.reserved,toughness:e.toughness,type_line:e.type_line,artist:e.artist,frame:e.frame,frame_effects:e.frame_effects,full_art:e.full_art,oversized:e.oversized,prices:e.prices,promo:e.promo,rarity:e.rarity,reprint:e.reprint,scryfall_set:e.set,set_name:e.set_name,set:e.set,variation:e.variation,variation_of:e.variation_of,finishes:e.finishes,foil:!1,quantity:1,set_uri:e.set_uri,buy_price:"0.00",notes:"",favourite:!1}}},5393:(e,r,a)=>{a.d(r,{Q:()=>l});var t=a(2115),s=a(4746),i=a(6203);function l(){let[e,r]=(0,t.useState)(null);return(0,t.useEffect)(()=>{let e=(0,i.hg)(s.j,e=>{r(e)});return()=>e()},[]),e}},5612:(e,r,a)=>{a.d(r,{A:()=>d});var t=a(5155),s=a(2115),i=a(4746),l=a(5317),n=a(5393),c=a(9265);let o=e=>{let{binder:r}=e,[a,o]=(0,s.useState)(!1),d=(0,s.useContext)(c.Q),u=(0,n.Q)();if(!d)throw Error("BinderContext not found.");let{currentBinder:m,setCurrentBinder:x}=d,b=async()=>{try{if(!u)return;for(let e of(await (0,l.getDocs)((0,l.collection)(i.db,"users",u.uid,"binders",r.id,"cards"))).docs){let r=(0,l.doc)(i.db,"users",u.uid,"binders","all","cards",e.data().id);await (0,l.updateDoc)(r,{binder:"all"})}await (0,l.deleteDoc)((0,l.doc)(i.db,"users",u.uid,"binders",r.id)),o(!1),x("all")}catch(e){console.error(e)}};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("button",{onClick:()=>o(!0),children:(0,t.jsx)("p",{className:"text-2xl hover:text-white cursor-pointer font-sans font-black",children:"⋮"})}),a&&(0,t.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>o(!1)}),a&&(0,t.jsx)("div",{className:"w-40 h-30 bg-[#141823] absolute z-50 top-1 left-5 rounded-md pt-2 pb-2 border border-gray-600",children:(0,t.jsx)("button",{className:"bg-[#141823] hover:bg-[#3f475a] w-full h-10 text-gray-300",onClick:()=>b(),children:"Delete"})})]})},d=e=>{let{viewOnly:r,paramID:a}=e,[d,u]=(0,s.useState)([]),[m,x]=(0,s.useState)(!1),[b,p]=(0,s.useState)(""),[f,h]=(0,s.useState)(null),g=(0,s.useContext)(c.Q),y=(0,s.useRef)(null),v=(0,n.Q)();if(!g)throw Error("BinderContext not found.");let{currentBinder:j,setCurrentBinder:w}=g;(0,s.useEffect)(()=>{(v||a)&&k("all")},[v]),(0,s.useEffect)(()=>{var e;p("New Binder"),null==(e=y.current)||e.select()},[m]),(0,s.useEffect)(()=>{_()},[j]);let _=async()=>{try{let e=a||(v?v.uid:null);if(!e)return;let r=(await (0,l.getDocs)((0,l.collection)(i.db,"users",e,"binders"))).docs.map(e=>({id:e.id,name:e.data().name,index:e.data().index,color:e.data().color}));u(r)}catch(e){console.error("Error fetching binders:",e)}},N=async(e,r,a)=>{a.preventDefault();try{if(!v)return;let a=e.trim(),t=await (0,l.query)((0,l.collection)(i.db,"users",v.uid,"binders"),(0,l.where)("name","==",a)),s=await (0,l.getDocs)(t);if(a||(a="New binder"),!s.empty){let e=1,r=a;for(;!s.empty;)a=r+"(".concat(e,")"),t=await (0,l.query)((0,l.collection)(i.db,"users",v.uid,"binders"),(0,l.where)("name","==",a)),s=await (0,l.getDocs)(t),e++}await (0,l.addDoc)((0,l.collection)(i.db,"users",v.uid,"binders"),{name:a,index:d.length,color:r}),x(!1),_()}catch(e){console.error("Error creating binder:",e)}},k=async e=>{w(e),console.log("Selected binder:",e),_()};return(0,t.jsxs)("div",{className:"flex flex-col bg-[#141822] h-full w-64 text-[#a9a9ab] font-sans font-medium p-1 rounded-tr-3xl rounded-br-3xl relative border-r border-t border-b border-gray-600",children:[(0,t.jsx)("div",{className:"absolute top-0 left-0 w-full h-full z-1 overflow-x-hidden",style:{backgroundImage:"\n                repeating-linear-gradient(0deg, rgba(36, 40, 61, 0.8) 0px, rgba(36, 40, 61, 0.8) 1px, transparent 1px, transparent 20px),\n                repeating-linear-gradient(90deg, rgba(36, 40, 61, 0.8) 0px, rgba(36, 40, 61, 0.8) 1px, transparent 1px, transparent 20px)\n                ",WebkitMaskImage:"radial-gradient(circle at 50% 50%, transparent 40%, white 100%)",maskImage:"radial-gradient(circle at 50% 50%, transparent 40%, white 100%)"}}),(0,t.jsxs)("div",{className:"flex items-center ml-2 z-10",children:[(0,t.jsx)("span",{children:(0,t.jsx)("img",{src:"/box.svg",className:"w-6",style:{filter:"invert(62%) sepia(0%) saturate(0%) hue-rotate(0deg) brightness(95%)"}})}),(0,t.jsx)("h1",{className:"m-2 text-[#cbcbcd] text-lg",children:"Binders"})]}),(0,t.jsx)("hr",{className:"text-[#373739] z-10"}),(0,t.jsx)("ul",{className:"p-3 z-40",children:d.slice().sort((e,r)=>e.index-r.index).map(e=>(0,t.jsxs)("li",{className:"cursor-pointer flex rounded-md h-9 w-full z-10 hover:bg-[#343a4ab6] items-center justify-between "+(e.id===j?"bg-[#343a4aad] text-white":"bg-[#14182200]"),onClick:()=>k(e.id),onMouseEnter:()=>h(e.id),onMouseLeave:()=>h(null),children:[(0,t.jsx)("p",{className:"ml-4",children:e.name}),(0,t.jsx)("span",{className:"mr-3 text-[#a9a9ab] relative",children:f!==e.id||"all"==e.id||r?null:(0,t.jsx)(o,{binder:e})})]},e.name))}),m&&(0,t.jsx)("div",{className:"border h-10 w-full bg-[#141822] z-10",children:(0,t.jsx)("form",{className:"flex items-center h-10 w-full bg-[#141822]",onSubmit:e=>N(b,"#92acb5",e),children:(0,t.jsx)("input",{className:"outline-none",type:"text",value:b,ref:y,autoFocus:!0,onBlur:e=>N(b,"#92acb5",e),onChange:e=>p(e.target.value)})})}),!r&&(0,t.jsxs)("button",{className:"rounded-lg group flex items-center pl-15 h-10 z-10 w-full bg-[#141822b2] hover:bg-[#343a4ab2] hover:text-white",onClick:()=>x(!0),children:[(0,t.jsx)("img",{src:"/plus.svg",className:"w-6 filter group-hover:brightness-200"}),(0,t.jsx)("p",{children:"New binder"})]})]})}},6035:(e,r,a)=>{a.d(r,{A:()=>j});var t=a(5155),s=a(2115),i=a(5393),l=a(9265),n=a(5317),c=a(4746);let o=e=>{let{card:r,onFlip:a,viewOnly:o}=e,[d,u]=(0,s.useState)(!1),m=(0,i.Q)(),x=(0,s.useContext)(l.Q),b=!!r.card_faces&&r.card_faces.length>1;if(!x)throw Error("BinderContext not found.");let{currentBinder:p,setCurrentBinder:f}=x,h=async(e,r)=>{if(m&&r){if("all"!=r)console.log("deleted from all"),await (0,n.deleteDoc)((0,n.doc)(c.db,"users",m.uid,"binders","all","cards",e.id));else{if(!e.binder)return;await (0,n.deleteDoc)((0,n.doc)(c.db,"users",m.uid,"binders",e.binder,"cards",e.id))}await (0,n.deleteDoc)((0,n.doc)(c.db,"users",m.uid,"binders",r,"cards",e.id))}};return(0,t.jsxs)(t.Fragment,{children:[!o&&(0,t.jsx)("div",{className:"absolute top-5 right-4 z-10 transition duration-500 ".concat(d?"opacity-100":"opacity-0 group-hover:opacity-100"),children:(0,t.jsx)("button",{className:"flex items-center justify-center p-1 w-10 h-8 rounded-xl bg-[#1a1b27d2] hover:bg-[#2b2c33c0]",onClick:()=>u(!0),children:(0,t.jsx)("span",{className:"mb-1 text-3xl font-sans font-semibold text-[#bebebe]",children:"⋯"})})}),(0,t.jsx)("div",{className:"absolute top-6 left-6 z-10 text-gray-300 bg-[#1a1b27d2] py-1 px-2 rounded-lg cursor-pointer transition duration-700 ".concat(d?"opacity-100":"opacity-0 group-hover:opacity-100"),children:(0,t.jsx)("p",{children:r.quantity})}),d&&(0,t.jsx)("div",{className:"fixed inset-0 z-40",onClick:()=>u(!1)}),d&&(0,t.jsx)("div",{className:"w-40 h-15 bg-[#141823] absolute z-50 top-1 left-5 rounded-md pt-2 pb-2 border border-gray-600",children:(0,t.jsx)("button",{className:"bg-[#141823] hover:bg-[#3f475a] w-full h-10 text-gray-300",onClick:()=>h(r,p),children:"Delete"})}),b&&(0,t.jsx)("div",{className:"absolute top-15 right-4 z-10 transition duration-500 ".concat(d?"opacity-100":"opacity-0 group-hover:opacity-100"),children:(0,t.jsx)("button",{className:"flex items-center justify-center p-1 w-10 h-8 rounded-xl bg-[#1a1b27d2] hover:bg-[#2b2c33c0]",onClick:()=>a(),children:(0,t.jsx)("img",{src:"/flip.svg",style:{filter:"invert(1) brightness(0.70)"}})})})]})};var d=a(5360);let u=e=>{var r,a;let{card:s}=e;return(0,t.jsxs)("div",{className:"w-100",children:[s.image_uris?(0,t.jsx)("img",{src:null==(r=s.image_uris)?void 0:r.png,className:"w-65 ml-10 mt-7",alt:s.card_name}):(0,t.jsx)("img",{src:null==(a=s.card_faces[0].image_uris)?void 0:a.png,className:"w-65 ml-10 mt-7",alt:s.card_name}),(0,t.jsxs)("div",{className:"flex ml-7 w-full h-8 justify-center items-center",children:[(0,t.jsx)("img",{src:"/tcgplayer.svg",className:"w-7",alt:"TCGPlayer"}),(0,t.jsxs)("p",{className:"",children:["$",s.prices.usd]})]}),(0,t.jsx)("a",{href:s.scryfallUri,target:"_blank",className:"ml-28 text-gray-400",children:"View on Scryfall"})]})},m=e=>{let{card:r,foil:a,favourite:s,onFoilChange:i,onFavouriteChange:l}=e;return(0,t.jsxs)("div",{className:"ml-8",children:[(0,t.jsx)("h2",{className:"mt-5",children:"Foil"}),(0,t.jsx)("button",{className:"bg-gray-700/40 border border-gray-600 h-10 w-18 rounded-md flex justify-center items-center text-2xl ".concat(a?"ring-2 ring-[#7d80ef]":""),onClick:()=>i(r,!a),children:a?"★":"☆"}),(0,t.jsx)("h2",{className:"mt-6",children:"Favourite"}),(0,t.jsx)("button",{className:"bg-gray-700/40 border border-gray-600 h-10 w-18 rounded-md flex justify-center items-center text-2xl ".concat(s?"ring-2 ring-[#7d80ef]":""),onClick:()=>l(r,!s),children:s?"★":"☆"})]})},x=e=>{let{card:r,cardQuantity:a,onQuantityChange:s,onQuantitySubmit:i}=e;return(0,t.jsxs)("div",{className:"ml-7",children:[(0,t.jsx)("p",{children:"Quantity"}),(0,t.jsx)("form",{onSubmit:e=>i(r,Number(a),e),children:(0,t.jsx)("input",{type:"number",className:"bg-gray-700/40 border border-gray-600 w-17 h-10 rounded-md pl-4",placeholder:String(r.quantity),value:a,onChange:e=>s(e.target.value),onBlur:e=>i(r,Number(a),e)})})]})},b=e=>{let{card:r,buyPrice:a,onPriceChange:s,onPriceSubmit:i}=e;return(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("h2",{children:"Buy Price"}),(0,t.jsxs)("form",{className:"flex bg-gray-700/40 border border-gray-600 w-23 h-10 rounded-md pl-3 items-center",onSubmit:e=>{e.preventDefault();let t=Number(a).toFixed(2);s(t),i(r,Number(t),e)},children:[(0,t.jsx)("span",{className:"mr-1",children:"$"}),(0,t.jsx)("input",{className:"w-16",type:"number",step:"0.01",placeholder:r.buy_price,value:a,onChange:e=>s(e.target.value),onBlur:e=>{let t=Number(a).toFixed(2);s(t),i(r,Number(t),e)}})]})]})},p=e=>{let{card:r,notes:a,onNotesChange:s,onNotesSubmit:i}=e;return(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Notes"}),(0,t.jsx)("form",{className:"flex w-83 h-45 rounded-xl items-center",onSubmit:e=>{e.preventDefault(),i(r,a,e)},children:(0,t.jsx)("textarea",{className:"w-full h-full bg-gray-700/40 border border-gray-600 rounded-xl p-2 resize-none text-white",value:a,placeholder:"Type notes here...",onChange:e=>s(e.target.value),onBlur:e=>i(r,e.target.value,e)})})]})},f=e=>{let{card:r,showConditions:a,conditions:s,onToggleShow:i,onConditionSelect:l}=e;return(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("h2",{children:"Condition"}),(0,t.jsxs)("button",{className:"bg-gray-700/40 border border-gray-600 h-10 w-18 rounded-md flex justify-between items-center pl-4",onClick:i,children:[(0,t.jsx)("span",{children:r.condition}),(0,t.jsx)("span",{className:"h-full flex justify-center items-center",children:(0,t.jsx)("img",{src:"/dropdown.svg",className:"w-7 filter invert",alt:"dropdown"})})]}),a&&(0,t.jsx)("ul",{className:"bg-gray-700 absolute w-18 border border-gray-500 rounded-md",children:s.map(e=>(0,t.jsx)("li",{className:"z-50 flex justify-center items-center h-8 hover:bg-gray-400 ".concat(r.condition==e?" bg-gray-400":" bg-gray-700"),onClick:()=>l(r,e),children:e},e))})]})},h=e=>{let{card:r,binderName:a,showBinders:s,binderList:i,onToggleShow:l,onBinderSelect:n}=e;return(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{children:"Binder"}),(0,t.jsxs)("button",{className:"bg-gray-700/40 border border-gray-600 h-10 w-60 rounded-md flex justify-between items-center pl-4",onClick:l,onBlur:()=>{s&&l()},children:[(0,t.jsx)("span",{children:a}),(0,t.jsx)("span",{className:"h-full flex justify-center items-center",children:(0,t.jsx)("img",{src:"/dropdown.svg",className:"w-7 filter invert",alt:"dropdown"})})]}),s&&(0,t.jsx)("ul",{className:"bg-gray-700 absolute w-60 border border-gray-500 rounded-md",children:i.map(e=>(0,t.jsx)("li",{className:"z-50 flex items-center pl-4 h-8 hover:bg-gray-400 ".concat(a==e?" bg-gray-400":" bg-gray-700"),onClick:()=>n(r,e),children:e},e))})]})},g=e=>{var r;let{card:a,printOpen:s,prints:i,showPreview:l,rarityFilter:n,onTogglePrintOpen:c,onViewPrints:o,onPrintHover:d,onPrintLeave:u,onPrintSelect:m}=e,x=e=>{e.image_uris?d(e):d(e.card_faces[0])};return(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{children:"Printing"}),(0,t.jsxs)("button",{className:"bg-gray-700/40 border border-gray-600 h-10 w-85 rounded-md flex justify-between items-center overflow-hidden",onClick:()=>{s||o(a),c()},onBlur:()=>{s&&c()},children:[(0,t.jsxs)("span",{className:"flex ml-4",children:[(0,t.jsx)("div",{className:"h-6 w-6 mr-2",style:{WebkitMaskImage:"url(/set_icons/".concat(a.set,".svg)"),maskImage:"url(/set_icons/".concat(a.set,".svg)"),WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskPosition:"center",maskPosition:"center",WebkitMaskSize:"contain",maskSize:"contain",background:"".concat(n[a.rarity])}}),(0,t.jsx)("span",{className:"whitespace-nowrap overflow-hidden max-w-65",children:a.set_name+" "+a.collector_number})]}),(0,t.jsx)("span",{className:"h-full flex justify-center items-center",children:(0,t.jsx)("img",{src:"/dropdown.svg",className:"w-7 filter invert",alt:"dropdown"})})]}),s&&(0,t.jsx)("div",{className:"absolute border border-gray-500 bg-gray-600 max-h-70 w-90 overflow-y-auto rounded-sm z-50",children:(0,t.jsx)("ul",{children:i.map(e=>(0,t.jsxs)("li",{className:"hover:bg-gray-500 px-3 py-1 ".concat(e.set_name==a.set_name&&e.collector_number==a.collector_number?" bg-gray-500":""),onMouseEnter:()=>x(e),onMouseLeave:u,onMouseDown:()=>m(a,e),children:[(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"h-5.5 w-5.5 mr-2",style:{WebkitMaskImage:"url(/set_icons/".concat(e.set,".svg)"),maskImage:"url(/set_icons/".concat(e.set,".svg)"),WebkitMaskRepeat:"no-repeat",maskRepeat:"no-repeat",WebkitMaskPosition:"center",maskPosition:"center",WebkitMaskSize:"contain",maskSize:"contain",background:"".concat(n[e.rarity])}}),"".concat(e.set_name," ").concat(e.collector_number)]}),(0,t.jsxs)("div",{className:"flex justify-between text-gray-400 ml-8",children:[(0,t.jsx)("p",{children:e.flavor_name||e.card_name}),(0,t.jsx)("p",{children:"".concat(e.prices.usd?"$".concat(e.prices.usd):"N/A")})]})]},e.set_name+e.collector_number))})}),l&&(0,t.jsx)("div",{className:"fixed -right-22 ml-10",children:(0,t.jsx)("img",{src:null==(r=l.image_uris)?void 0:r.normal,className:"w-50 rounded-lg",alt:"card preview"})})]})},y=e=>{let{card:r}=e,[o,y]=(0,s.useState)(!1),[v,j]=(0,s.useState)([r]),[w,_]=(0,s.useState)(null),[N,k]=(0,s.useState)(String(r.quantity)),[C,D]=(0,s.useState)(r.buy_price?String(Number(r.buy_price).toFixed(2)):"0.00"),[S,z]=(0,s.useState)(""),[E,F]=(0,s.useState)(!1),[P,I]=(0,s.useState)(["All Cards"]),[M,B]=(0,s.useState)(!1),[Q,A]=(0,s.useState)(r.notes||""),[L,T]=(0,s.useState)(r.foil),[W,U]=(0,s.useState)(r.favourite||!1),q=(0,s.useRef)(new Map),R=(0,s.useContext)(l.Q),O=(0,i.Q)();if(!R)throw Error("BinderContext not found.");let{currentBinder:$,triggerCardsUpdate:G}=R,V=async e=>{try{let r=e.prints_search_uri,a=await fetch(r),t=await a.json(),s=[];t.data.forEach(e=>{s.push((0,d.z)(e,$))}),j(s)}catch(e){console.error(e)}},H=async(e,a,t)=>{try{if(!O||!O.uid||!t)return console.error("No user or binder found."),!1;if("all"!=t)await (0,n.updateDoc)((0,n.doc)(c.db,"users",null==O?void 0:O.uid,"binders",t,"cards",e),{...a});else{let t=r.binder;"all"!=t&&t&&await (0,n.updateDoc)((0,n.doc)(c.db,"users",null==O?void 0:O.uid,"binders",t,"cards",e),{...a})}return await (0,n.updateDoc)((0,n.doc)(c.db,"users",null==O?void 0:O.uid,"binders","all","cards",e),{...a}),!0}catch(e){return console.error("Failed to update card: ",e),!1}},K=async(e,r)=>{try{if(!O||!O.uid||!$)return void console.log("Error");if("all"!=$)await (0,n.updateDoc)((0,n.doc)(c.db,"users",null==O?void 0:O.uid,"binders",$,"cards",e.id),{collector_number:r.collector_number,image_uris:r.image_uris,prices:r.prices,rarity:r.rarity,scryfallId:r.scryfallId,scryfallUri:r.scryfallUri,set:r.set,set_name:r.set_name,set_uri:r.set_uri,uri:r.uri,...r.card_faces?{card_faces:r.card_faces}:{}}),r.flavor_name&&await (0,n.updateDoc)((0,n.doc)(c.db,"users",O.uid,"binders",$,"cards",e.id),{flavor_name:r.flavor_name});else{let a=e.binder;"all"!=a&&a&&(await (0,n.updateDoc)((0,n.doc)(c.db,"users",null==O?void 0:O.uid,"binders",a,"cards",e.id),{collector_number:r.collector_number,image_uris:r.image_uris,prices:r.prices,rarity:r.rarity,scryfallId:r.scryfallId,scryfallUri:r.scryfallUri,set:r.set,set_name:r.set_name,set_uri:r.set_uri,uri:r.uri,...r.card_faces?{card_faces:r.card_faces}:{}}),r.flavor_name&&await (0,n.updateDoc)((0,n.doc)(c.db,"users",O.uid,"binders",a,"cards",e.id),{flavor_name:r.flavor_name}))}await (0,n.updateDoc)((0,n.doc)(c.db,"users",null==O?void 0:O.uid,"binders","all","cards",e.id),{collector_number:r.collector_number,image_uris:r.image_uris,prices:r.prices,rarity:r.rarity,scryfallId:r.scryfallId,scryfallUri:r.scryfallUri,set:r.set,set_name:r.set_name,set_uri:r.set_uri,uri:r.uri,...r.card_faces?{card_faces:r.card_faces}:{}}),r.flavor_name&&await (0,n.updateDoc)((0,n.doc)(c.db,"users",O.uid,"binders","all","cards",e.id),{flavor_name:r.flavor_name}),G(),_(null)}catch(e){console.error(e)}},X=async(e,r,a)=>{try{a.preventDefault(),await H(e.id,{quantity:r},$)||console.error("Failed to update quantity"),G()}catch(e){console.error(e)}},J=async(e,r,a)=>{try{a.preventDefault(),await H(e.id,{buy_price:String(r)},$)||console.error("Failed to update buy price")}catch(e){console.error(e)}},Y=async(e,r,a)=>{try{var t;a&&(null==(t=a.preventDefault)||t.call(a)),await H(e.id,{notes:r},$)||console.error("Failed to update notes")}catch(e){console.error(e)}},Z=async(e,r)=>{try{await H(e.id,{condition:r},$)||console.error("Failed to update condition"),B(!1)}catch(e){console.error(e)}},ee=async(e,r)=>{try{if(!O||!O.uid||!$)return void console.log("Error");let a=q.current.get(r);if(!a)return void console.error("Invalid binder selected:",r);let t=(0,n.doc)(c.db,"users",O.uid,"binders",$,"cards",e.id),s=(0,n.doc)(c.db,"users",O.uid,"binders",a,"cards",e.id);if("all"!=$){await (0,n.updateDoc)((0,n.doc)(c.db,"users",null==O?void 0:O.uid,"binders",$,"cards",e.id),{binder:a});let r=(await (0,n.getDoc)(t)).data();await (0,n.setDoc)(s,r,{merge:!0}),await (0,n.deleteDoc)(t)}else{let r=e.binder;if("all"!=r&&r){await (0,n.updateDoc)((0,n.doc)(c.db,"users",null==O?void 0:O.uid,"binders",r,"cards",e.id),{binder:a});let t=(0,n.doc)(c.db,"users",O.uid,"binders",r,"cards",e.id),i=(await (0,n.getDoc)(t)).data();await (0,n.setDoc)(s,i,{merge:!0}),await (0,n.deleteDoc)(t)}else{await (0,n.updateDoc)((0,n.doc)(c.db,"users",null==O?void 0:O.uid,"binders","all","cards",e.id),{binder:a});let r=(0,n.doc)(c.db,"users",O.uid,"binders","all","cards",e.id),t=(await (0,n.getDoc)(r)).data();await (0,n.setDoc)(s,t,{merge:!0})}}await (0,n.updateDoc)((0,n.doc)(c.db,"users",null==O?void 0:O.uid,"binders","all","cards",e.id),{binder:a}),G(),F(!1)}catch(e){console.error(e)}},er=async(e,r)=>{try{T(r),await H(e.id,{foil:r},$)||console.error("Failed to update foil")}catch(e){console.error(e)}},ea=async(e,r)=>{try{U(r),await H(e.id,{favourite:r},$)||console.error("Failed to update favourite")}catch(e){console.error(e)}};return(0,s.useEffect)(()=>{(async()=>{if(O&&r.binder)try{let e=(0,n.doc)(c.db,"users",O.uid,"binders",r.binder),t=await (await Promise.resolve().then(a.bind(a,5317))).getDoc(e);t.exists()?z(t.data().name||r.binder):z(r.binder)}catch(e){z(r.binder)}})()},[O,r.binder]),(0,s.useEffect)(()=>{(async()=>{if(O)try{let e=[];(await (0,n.getDocs)((0,n.collection)(c.db,"users",O.uid,"binders"))).forEach(r=>{e.push({name:r.data().name,index:r.data().index}),q.current.set(r.data().name,r.id)}),e.sort((e,r)=>e.index-r.index),I(e.map(e=>e.name))}catch(e){console.error(e)}})()},[O,$]),(0,t.jsxs)("div",{className:"flex flex-col w-200 h-140 bg-[#192131]/70 rounded-lg text-white",children:[(0,t.jsx)("div",{className:"flex items-center pl-8 pt-6 w-full h-15",children:(0,t.jsx)("h1",{className:"text-2xl",children:"Card Properties"})}),(0,t.jsx)("hr",{className:"m-2 text-white/25"}),(0,t.jsxs)("div",{className:"flex w-full h-full",children:[(0,t.jsx)(u,{card:r}),(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsx)("div",{className:"flex w-100 justify-center mt-5 ml-15 break-words",children:(0,t.jsx)("h2",{className:"text-2xl",children:(r.flavor_name||r.card_name||"").split("//").map((e,r,a)=>(0,t.jsxs)("span",{children:[e,r<a.length-1&&(0,t.jsx)("br",{})]},r))})}),(0,t.jsxs)("div",{className:"flex w-full h-15 ml-15",children:[(0,t.jsx)(g,{card:r,printOpen:o,prints:v,showPreview:w,rarityFilter:{common:"black",uncommon:"radial-gradient(circle at 50% 75%, #ececec 0%, #737373 60%, #666666 100%)",rare:"radial-gradient(circle at 50% 75%, #fbeca8 0%, #967c03 60%, #c6a405 100%)",mythic:"radial-gradient(circle at 50% 75%, #fac438 0%, #d96421 60%, #c35008 100%)"},onTogglePrintOpen:()=>y(!o),onViewPrints:V,onPrintHover:_,onPrintLeave:()=>_(null),onPrintSelect:K}),(0,t.jsx)(x,{card:r,cardQuantity:N,onQuantityChange:k,onQuantitySubmit:X})]}),(0,t.jsxs)("div",{className:"flex w-full h-15 ml-15 mt-5",children:[(0,t.jsx)(h,{card:r,binderName:S,showBinders:E,binderList:P,onToggleShow:()=>F(!E),onBinderSelect:ee}),(0,t.jsx)(f,{card:r,showConditions:M,conditions:["NM","LP","MP","HP","DMG"],onToggleShow:()=>B(!M),onConditionSelect:Z}),(0,t.jsx)(b,{card:r,buyPrice:C,onPriceChange:D,onPriceSubmit:J})]}),(0,t.jsxs)("div",{className:"flex w-auto h-50 ml-15 mt-5",children:[(0,t.jsx)(p,{card:r,notes:Q,onNotesChange:A,onNotesSubmit:Y}),(0,t.jsx)(m,{card:r,foil:L,favourite:W,onFoilChange:er,onFavouriteChange:ea})]})]})]})]})},v=e=>{var r,a,i,l,n,c;let{card:d,viewOnly:u}=e,[m,x]=(0,s.useState)(!1),[b,p]=(0,s.useState)(!1),[f,h]=(0,s.useState)(!1),g=()=>{x(!0),setTimeout(()=>p(!0),10)},v=()=>{p(!1),setTimeout(()=>x(!1),400)},j=()=>{h(!f)};return(0,t.jsx)(t.Fragment,{children:d.image_uris&&d.card_faces.length<2?(0,t.jsxs)("div",{className:"flex-1 min-w-56 max-w-60 relative group",children:[(0,t.jsx)(o,{card:d,onFlip:j,viewOnly:u}),(0,t.jsx)("img",{src:d.image_uris.large,alt:d.card_name,className:"rounded-xl w-full cursor-pointer",onClick:()=>g()}),(0,t.jsxs)("div",{className:"w-full h-full flex justify-center cursor-default text-[#7d80ef]",children:[(0,t.jsx)("img",{src:"/tcgplayer.svg",className:"w-7"}),d.prices.usd&&"$"+d.prices.usd,!d.prices.usd&&"N/A"]}),m&&!u&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-50",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black z-40 transition-opacity duration-500 ".concat(b?" opacity-50":" opacity-0"),onClick:()=>v()}),(0,t.jsx)("div",{className:"relative z-50 backdrop-blur-md transition-opacity duration-500 ".concat(b?" opacity-100":" opacity-0"),onClick:e=>e.stopPropagation(),children:(0,t.jsx)(y,{card:d})})]})]}):d.card_faces?(0,t.jsxs)("div",{className:"flex-1 min-w-55 max-w-60 relative group",children:[(0,t.jsx)(o,{card:d,onFlip:j,viewOnly:u}),(0,t.jsx)("div",{className:"flip-container",children:(0,t.jsxs)("div",{className:"flip-card ".concat(f?"flipped":""),children:[(0,t.jsx)("img",{src:null==(i=d.card_faces)||null==(a=i[0])||null==(r=a.image_uris)?void 0:r.large,alt:d.card_name,className:"rounded-xl w-full cursor-pointer absolute card-front",onClick:()=>g()}),(0,t.jsx)("img",{src:null==(c=d.card_faces)||null==(n=c[1])||null==(l=n.image_uris)?void 0:l.large,alt:d.card_name,className:"rounded-xl w-full cursor-pointer card-back",onClick:()=>g()})]})}),(0,t.jsxs)("div",{className:"w-full h-full flex justify-center cursor-default text-[#7d80ef]",children:[(0,t.jsx)("img",{src:"/tcgplayer.svg",className:"w-7"}),d.prices.usd&&"$"+d.prices.usd,!d.prices.usd&&"N/A"]}),m&&!u&&(0,t.jsxs)("div",{className:"fixed inset-0 z-50 flex items-start justify-center pt-50",children:[(0,t.jsx)("div",{className:"fixed inset-0 bg-black z-40 transition-opacity duration-500 ".concat(b?" opacity-50":" opacity-0"),onClick:()=>v()}),(0,t.jsx)("div",{className:"relative z-50 backdrop-blur-md transition-opacity duration-500 ".concat(b?" opacity-100":" opacity-0"),onClick:e=>e.stopPropagation(),children:(0,t.jsx)(y,{card:d})})]})]}):null})},j=e=>{let{viewOnly:r,paramID:a}=e,[o,d]=(0,s.useState)([]),[u,m]=(0,s.useState)(""),x=(0,i.Q)(),b=(0,s.useContext)(l.Q);if(!b)throw Error("BinderContext not found.");let{currentBinder:p,setCurrentBinder:f}=b,h=async(e,r)=>{try{let t;if(!x&&!a)return void console.log("how did this happen");let s=Date.now();if(e.last_price_update&&("object"==typeof e.last_price_update&&null!==e.last_price_update&&"toDate"in e.last_price_update&&"function"==typeof e.last_price_update.toDate?t=e.last_price_update.toDate().getTime():e.last_price_update instanceof Date?t=e.last_price_update.getTime():("string"==typeof e.last_price_update||"number"==typeof e.last_price_update)&&(t=new Date(e.last_price_update).getTime())),void 0===t||s-t>864e5){let a=await fetch("https://api.scryfall.com/cards/".concat(e.scryfallId));if(!a.ok)return;let t=await a.json();await (0,n.updateDoc)((0,n.doc)(c.db,"users",u,"binders",r,"cards",e.id),{prices:t.prices,last_price_update:new Date}),d(r=>r.map(r=>r.id===e.id?{...r,prices:t.prices,last_price_update:new Date}:r))}}catch(e){console.error(e)}};return(0,s.useEffect)(()=>{if(!p||!x&&!a)return;let e=a||(x?x.uid:"N/A");m(e);let r=(0,n.onSnapshot)((0,n.collection)(c.db,"users",e,"binders",p,"cards"),e=>{d(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>r()},[p,x]),(0,s.useEffect)(()=>{x&&p&&o.forEach(e=>{h(e,p)})},[o,x,p]),(0,t.jsx)("div",{className:"flex flex-wrap gap-4 w-full pt-5 pl-13 items-start bg-[#181e2b]",children:o.map(e=>(0,t.jsx)(v,{card:e,viewOnly:r},e.id))})}},9265:(e,r,a)=>{a.d(r,{Q:()=>i,y:()=>l});var t=a(5155),s=a(2115);let i=(0,s.createContext)(null),l=e=>{let{children:r}=e,[a,l]=(0,s.useState)("All Cards"),[n,c]=(0,s.useState)(0);return(0,t.jsx)(i.Provider,{value:{currentBinder:a,setCurrentBinder:l,cardsUpdated:n,triggerCardsUpdate:()=>{c(e=>e+1)}},children:r})}}}]);