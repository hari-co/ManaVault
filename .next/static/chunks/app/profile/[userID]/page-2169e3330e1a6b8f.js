(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[655],{1623:(e,s,t)=>{Promise.resolve().then(t.bind(t,8234))},4746:(e,s,t)=>{"use strict";t.d(s,{db:()=>o,j:()=>n});var a=t(3915),r=t(6203),i=t(5317);let l=(0,a.Dk)().length?(0,a.Dk)()[0]:(0,a.Wp)({apiKey:"AIzaSyAG8nkDy9a4f3VaPzNyKFCbAL7vAWXP39E",authDomain:"manavault-e2506.firebaseapp.com",projectId:"manavault-e2506",storageBucket:"manavault-e2506.firebasestorage.app",messagingSenderId:"384906228232",appId:"1:384906228232:web:1902c364b45ba6a2c617bd",measurementId:"G-5XN99F3RBC"}),n=(0,r.xI)(l),o=(0,i.getFirestore)(l)},8234:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var a=t(5155),r=t(2115),i=t(6203),l=t(4746),n=t(5317),o=t(5695);let c=e=>{let{currentUser:s,targetUserId:t,isOwnProfile:i}=e,[o,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{if(s&&!i)try{let e=(0,n.doc)(l.db,"users",s.uid,"profile","following"),a=await (0,n.getDoc)(e);if(a.exists()){let e=a.data().userIds||[];c(e.includes(t))}else c(!1)}catch(e){console.error("Error checking follow status:",e)}})()},[s,t,i]);let x=async()=>{if(s&&!d){u(!0);try{let e=(0,n.doc)(l.db,"users",s.uid,"profile","following"),a=(0,n.doc)(l.db,"users",t,"profile","followers");o?(await (0,n.updateDoc)(e,{userIds:(0,n.arrayRemove)(t)}).catch(async()=>{await (0,n.setDoc)(e,{userIds:[]})}),await (0,n.updateDoc)(a,{userIds:(0,n.arrayRemove)(s.uid)}).catch(async()=>{await (0,n.setDoc)(a,{userIds:[]})})):(await (0,n.updateDoc)(e,{userIds:(0,n.arrayUnion)(t)}).catch(async()=>{await (0,n.setDoc)(e,{userIds:[t]})}),await (0,n.updateDoc)(a,{userIds:(0,n.arrayUnion)(s.uid)}).catch(async()=>{await (0,n.setDoc)(a,{userIds:[s.uid]})})),c(!o)}catch(e){console.error("Error updating follow status:",e)}finally{u(!1)}}};return!s||i?null:(0,a.jsx)("button",{onClick:x,disabled:d,className:"px-4 py-1 rounded text-sm font-medium transition-colors disabled:opacity-50 ".concat(o?"bg-gray-600 text-white hover:bg-red-600 hover:text-white":"bg-[#616dc9] text-white hover:bg-[#5159b3]"),children:d?"Loading...":o?"Following":"Follow"})};var d=t(6874),u=t.n(d);function x(e){let{isOpen:s,onClose:t,userId:i,followingCount:o}=e,[c,d]=(0,r.useState)([]),[x,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{s&&o>0&&h()},[s,i,o]);let h=async()=>{m(!0);try{let e=(0,n.doc)(l.db,"users",i,"profile","following"),s=await (0,n.getDoc)(e);if(s.exists()){let e=s.data().userIds||[],t=await Promise.all(e.map(async e=>{let s=await (0,n.getDoc)((0,n.doc)(l.db,"users",e));return s.exists()?{...s.data(),uid:e}:null}));d(t.filter(e=>null!==e))}}catch(e){console.error("Error fetching following users:",e)}finally{m(!1)}};return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-[#000000b2] flex items-center justify-center z-50",onClick:t,children:(0,a.jsxs)("div",{className:"bg-[#141823] rounded-lg p-6 w-96 max-h-96 overflow-y-auto border border-gray-500 transform transition-all duration-300 scale-100",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold",children:["Following (",o,")"]}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),x?(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("div",{className:"text-gray-400",children:"Loading..."})}):0===c.length?(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("div",{className:"text-gray-400",children:"Not following anyone yet."})}):(0,a.jsx)("div",{className:"space-y-3",children:c.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-2 hover:bg-[#181e2c] rounded transition-colors",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("div",{className:"w-5 h-5 bg-gray-400",style:{maskImage:"url(/user.svg)",maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:"url(/user.svg)",WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"}})}),(0,a.jsx)("div",{children:(0,a.jsx)(u(),{href:"/profile/".concat(e.uid),className:"font-medium text-white hover:text-[#616dc9] transition-colors",children:e.username})})]},e.uid))})]})}):null}function m(e){let{isOpen:s,onClose:t,userId:i,followersCount:o}=e,[c,d]=(0,r.useState)([]),[x,m]=(0,r.useState)(!1);(0,r.useEffect)(()=>{s&&o>0&&h()},[s,i,o]);let h=async()=>{m(!0);try{let e=(0,n.doc)(l.db,"users",i,"profile","followers"),s=await (0,n.getDoc)(e);if(s.exists()){let e=s.data().userIds||[],t=await Promise.all(e.map(async e=>{let s=await (0,n.getDoc)((0,n.doc)(l.db,"users",e));return s.exists()?{...s.data(),uid:e}:null}));d(t.filter(e=>null!==e))}}catch(e){console.error("Error fetching followers users:",e)}finally{m(!1)}};return s?(0,a.jsx)("div",{className:"fixed inset-0 bg-[#000000b2] flex items-center justify-center z-50",onClick:t,children:(0,a.jsxs)("div",{className:"bg-[#141823] rounded-lg p-6 w-96 max-h-96 overflow-y-auto border border-gray-500 transform transition-all duration-300 scale-100",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("h2",{className:"text-xl font-semibold",children:["Followers (",o,")"]}),(0,a.jsx)("button",{onClick:t,className:"text-gray-400 hover:text-white transition-colors",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),x?(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("div",{className:"text-gray-400",children:"Loading..."})}):0===c.length?(0,a.jsx)("div",{className:"text-center py-4",children:(0,a.jsx)("div",{className:"text-gray-400",children:"No followers yet."})}):(0,a.jsx)("div",{className:"space-y-3",children:c.map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-2 hover:bg-[#181e2c] rounded transition-colors",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("div",{className:"w-5 h-5 bg-gray-400",style:{maskImage:"url(/user.svg)",maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:"url(/user.svg)",WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"}})}),(0,a.jsx)("div",{children:(0,a.jsx)(u(),{href:"/profile/".concat(e.uid),className:"font-medium text-white hover:text-[#616dc9] transition-colors",children:e.username})})]},e.uid))})]})}):null}function h(e){let{followingCount:s,followersCount:t,isOwnProfile:i,userId:o}=e,[c,d]=(0,r.useState)(!1),[h,f]=(0,r.useState)(!1),[g,p]=(0,r.useState)([]),[b,y]=(0,r.useState)([]),[v,w]=(0,r.useState)(!1);(0,r.useEffect)(()=>{j()},[o,s,t]);let j=async()=>{w(!0);try{let e=(0,n.doc)(l.db,"users",o,"profile","following"),s=await (0,n.getDoc)(e);if(s.exists()){let e=(s.data().userIds||[]).slice(0,7),t=await Promise.all(e.map(async e=>{let s=await (0,n.getDoc)((0,n.doc)(l.db,"users",e));return s.exists()?{...s.data(),uid:e}:null}));p(t.filter(e=>null!==e))}let t=(0,n.doc)(l.db,"users",o,"profile","followers"),a=await (0,n.getDoc)(t);if(a.exists()){let e=(a.data().userIds||[]).slice(0,7),s=await Promise.all(e.map(async e=>{let s=await (0,n.getDoc)((0,n.doc)(l.db,"users",e));return s.exists()?{...s.data(),uid:e}:null}));y(s.filter(e=>null!==e))}}catch(e){console.error("Error fetching preview data:",e)}finally{w(!1)}};return(0,a.jsxs)("div",{className:"w-80",children:[(0,a.jsx)("div",{className:"bg-[#141823] shadow rounded-lg p-6 border border-gray-500",children:(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>d(!0),className:"text-xl font-semibold mb-3 hover:text-[#616dc9] transition-colors cursor-pointer",children:["Following (",s,")"]}),(0,a.jsx)("div",{className:"space-y-2 min-h-[280px]",children:v?(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Loading..."}):0===s?(0,a.jsx)("div",{className:"text-sm text-gray-500",children:i?"You're not following anyone yet.":"Not following anyone yet."}):(0,a.jsx)("div",{className:"space-y-2",children:g.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-2 hover:bg-[#181e2c] rounded transition-colors",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("div",{className:"w-5 h-5 bg-gray-400",style:{maskImage:"url(/user.svg)",maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:"url(/user.svg)",WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"}})}),(0,a.jsx)(u(),{href:"/profile/".concat(e.uid),className:"text-sm text-white hover:text-[#616dc9] transition-colors",children:e.username})]},e.uid))})})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("button",{onClick:()=>f(!0),className:"text-xl font-semibold mb-3 hover:text-[#616dc9] transition-colors cursor-pointer",children:["Followers (",t,")"]}),(0,a.jsx)("div",{className:"space-y-2 min-h-[280px]",children:v?(0,a.jsx)("div",{className:"text-xs text-gray-400",children:"Loading..."}):0===t?(0,a.jsx)("div",{className:"text-sm text-gray-500",children:i?"No followers yet.":"No followers."}):(0,a.jsx)("div",{className:"space-y-2",children:b.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-2 hover:bg-[#181e2c] rounded transition-colors",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("div",{className:"w-5 h-5 bg-gray-400",style:{maskImage:"url(/user.svg)",maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:"url(/user.svg)",WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"}})}),(0,a.jsx)(u(),{href:"/profile/".concat(e.uid),className:"text-sm text-white hover:text-[#616dc9] transition-colors",children:e.username})]},e.uid))})})]})]})}),(0,a.jsx)(x,{isOpen:c,onClose:()=>d(!1),userId:o,followingCount:s}),(0,a.jsx)(m,{isOpen:h,onClose:()=>f(!1),userId:o,followersCount:t})]})}function f(){var e,s,t;let[d,u]=(0,r.useState)(null),[x,m]=(0,r.useState)(null),[f,g]=(0,r.useState)(!0),[p,b]=(0,r.useState)(0),[y,v]=(0,r.useState)(0),[w,j]=(0,r.useState)(!1),[k,N]=(0,r.useState)(""),I=(0,o.useRouter)(),D=(0,o.useParams)();(0,r.useEffect)(()=>{let e=(0,i.hg)(l.j,async e=>{u(e);try{let e=await (0,n.getDoc)((0,n.doc)(l.db,"users",D.userID));if(e.exists()){let s=e.data();m(s)}let s=(0,n.doc)(l.db,"users",D.userID,"profile","description"),t=await (0,n.getDoc)(s);if(t.exists()){let e=t.data().description||"";N(e),m(s=>s?{...s,description:e}:null)}else N("");let a=(0,n.doc)(l.db,"users",D.userID,"profile","following"),r=await (0,n.getDoc)(a);if(r.exists()){let e=r.data().userIds||[];b(e.length)}else b(0);let i=(0,n.doc)(l.db,"users",D.userID,"profile","followers"),o=await (0,n.getDoc)(i);if(o.exists()){let e=o.data().userIds||[];v(e.length)}else v(0)}catch(e){console.error("Error fetching profile:",e)}finally{g(!1)}});return()=>e()},[I,D.userID]);let S=async()=>{if(d)try{let e=(0,n.doc)(l.db,"users",D.userID,"profile","description");await (0,n.setDoc)(e,{description:k}),m(e=>e?{...e,description:k}:null),j(!1)}catch(e){console.error("Error updating bio:",e)}},C=(null==d?void 0:d.uid)===D.userID;return f?(0,a.jsx)("div",{className:"p-4",children:"Loading..."}):x?(0,a.jsxs)("div",{className:"p-8 max-w-7xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Profile"}),(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsx)("div",{className:"flex-1 space-y-6",children:(0,a.jsx)("div",{className:"bg-[#141823] shadow rounded-lg p-6 border border-gray-500 h-[720px]",children:(0,a.jsxs)("div",{className:"flex items-start space-x-4 mb-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gray-600 rounded-full flex items-center justify-center flex-shrink-0",children:(0,a.jsx)("div",{className:"w-8 h-8 bg-gray-400",style:{maskImage:"url(/user.svg)",maskSize:"contain",maskRepeat:"no-repeat",maskPosition:"center",WebkitMaskImage:"url(/user.svg)",WebkitMaskSize:"contain",WebkitMaskRepeat:"no-repeat",WebkitMaskPosition:"center"}})}),(0,a.jsxs)("div",{className:"flex flex-1 min-w-0 space-x-4",children:[(0,a.jsxs)("div",{className:"flex-shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-1",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-white",children:x.username}),d&&(0,a.jsx)(c,{currentUser:d,targetUserId:D.userID,isOwnProfile:C})]}),(0,a.jsxs)("p",{className:"text-sm text-gray-400",children:["Member since ",(null==(t=x.createdAt)||null==(s=t.toDate)||null==(e=s.call(t))?void 0:e.toLocaleDateString())||"Unknown"]}),(0,a.jsx)("button",{onClick:()=>I.push("/library/".concat(D.userID)),className:"mt-2 px-4 py-2 text-sm bg-[#616dc9] text-white rounded hover:bg-[#5159b3] transition-colors",children:"View Library"})]}),(0,a.jsx)("div",{className:"flex-1 min-w-0",children:(0,a.jsx)("div",{className:"text-sm text-gray-300 min-h-[120px]",children:w?(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("textarea",{value:k,onChange:e=>N(e.target.value),placeholder:"Tell the community about yourself!",className:"w-full p-2 bg-[#181e2c] border border-gray-500 rounded text-sm text-white resize-none",rows:3,maxLength:200}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("span",{className:"text-xs text-gray-400",children:[k.length,"/200"]}),(0,a.jsxs)("div",{className:"space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{N((null==x?void 0:x.description)||""),j(!1)},className:"px-3 py-1 text-xs bg-gray-600 text-white rounded hover:bg-gray-500 transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:S,className:"px-3 py-1 text-xs bg-[#616dc9] text-white rounded hover:bg-[#5159b3] transition-colors",children:"Save"})]})]})]}):(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsx)("p",{className:(null==x?void 0:x.description)?"text-gray-300":"italic text-gray-400",children:(null==x?void 0:x.description)||"No bio yet. Tell the community about yourself!"}),C&&(0,a.jsx)("button",{onClick:()=>{j(!0)},className:"ml-2 px-3 py-1 text-xs bg-[#616dc9] text-white rounded hover:bg-[#5159b3] transition-colors flex-shrink-0",children:"Edit Bio"})]})})})]})]})})}),(0,a.jsx)(h,{followingCount:p,followersCount:y,isOwnProfile:C,userId:D.userID})]})]}):(0,a.jsx)("div",{className:"p-4",children:"Profile not found"})}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,811,75,874,441,684,358],()=>s(1623)),_N_E=e.O()}]);